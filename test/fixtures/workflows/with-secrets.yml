name: Workflow with Secrets
on:
  workflow_dispatch:

jobs:
  secret-test:
    runs-on: ubuntu-latest
    steps:
      - name: Test secret access
        env:
          API_KEY: ${{ secrets.API_KEY }}
          DATABASE_URL: ${{ secrets.DATABASE_URL }}
        run: |
          # Test that secrets are available
          if [ -z "$API_KEY" ]; then
            echo "ERROR: API_KEY secret not found"
            exit 1
          fi
          
          if [ -z "$DATABASE_URL" ]; then
            echo "ERROR: DATABASE_URL secret not found"
            exit 1
          fi
          
          echo "✓ Secrets are available"
          echo "API_KEY length: ${#API_KEY}"
          echo "DATABASE_URL length: ${#DATABASE_URL}"
      
      - name: Use secret in API call
        env:
          API_KEY: ${{ secrets.API_KEY }}
        run: |
          # Simulated API call
          echo "Making API call with authentication..."
          echo "Authorization: Bearer ***" # Never log actual secrets
          echo "✓ API call successful"